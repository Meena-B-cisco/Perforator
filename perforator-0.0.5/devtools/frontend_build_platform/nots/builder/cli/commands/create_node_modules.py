from argparse import ArgumentParser
from dataclasses import dataclass

from devtools.frontend_build_platform.libraries.logging import timeit

from devtools.frontend_build_platform.nots.builder.api import BaseOptions, create_node_modules


@dataclass
class CreateNodeModulesOptions(BaseOptions):
    moddir = str
    """Special value for MODDIR, overriding common value"""


def create_node_modules_parser(subparsers) -> ArgumentParser:
    subparser = subparsers.add_parser('create-node-modules', help="create node_modules directory")

    subparser.add_argument('--moddir', required=True, help="Special value for MODDIR, overriding common value")

    subparser.set_defaults(func=create_node_modules_func)

    return subparser


@timeit
def create_node_modules_func(args: CreateNodeModulesOptions):
    create_node_modules(args)
